module.exports=[12964,a=>{"use strict";a.s(["logoutUser",()=>d]);var b=a.i(37936),c=a.i(5246);async function d(){try{return(await (0,c.cookies)()).delete("token"),console.log("로그아웃 성공"),{success:!0}}catch(a){return console.error("로그아웃 에러:",a),{success:!1,error:"로그아웃 중 오류가 발생했습니다."}}}(0,a.i(13095).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"00bf9bc1e293f156175d3d49e4edd92075726affdf",null)},93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},62212,a=>{a.n(a.i(66114))},21170,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RedirectStatusCode",{enumerable:!0,get:function(){return d}});var d=function(a){return a[a.SeeOther=303]="SeeOther",a[a.TemporaryRedirect=307]="TemporaryRedirect",a[a.PermanentRedirect=308]="PermanentRedirect",a}({});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},28859,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{REDIRECT_ERROR_CODE:function(){return e},RedirectType:function(){return f},isRedirectError:function(){return g}});let d=a.r(21170),e="NEXT_REDIRECT";var f=function(a){return a.push="push",a.replace="replace",a}({});function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,f]=b,g=b.slice(2,-2).join(";"),h=Number(b.at(-2));return c===e&&("replace"===f||"push"===f)&&"string"==typeof g&&!isNaN(h)&&h in d.RedirectStatusCode}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},44868,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{getRedirectError:function(){return g},getRedirectStatusCodeFromError:function(){return l},getRedirectTypeFromError:function(){return k},getURLFromRedirectError:function(){return j},permanentRedirect:function(){return i},redirect:function(){return h}});let d=a.r(21170),e=a.r(28859),f=a.r(20635).actionAsyncStorage;function g(a,b,c){void 0===c&&(c=d.RedirectStatusCode.TemporaryRedirect);let f=Object.defineProperty(Error(e.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return f.digest=e.REDIRECT_ERROR_CODE+";"+b+";"+a+";"+c+";",f}function h(a,b){var c;throw null!=b||(b=(null==f||null==(c=f.getStore())?void 0:c.isAction)?e.RedirectType.push:e.RedirectType.replace),g(a,b,d.RedirectStatusCode.TemporaryRedirect)}function i(a,b){throw void 0===b&&(b=e.RedirectType.replace),g(a,b,d.RedirectStatusCode.PermanentRedirect)}function j(a){return(0,e.isRedirectError)(a)?a.digest.split(";").slice(2,-2).join(";"):null}function k(a){if(!(0,e.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return a.digest.split(";",2)[1]}function l(a){if(!(0,e.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(a.digest.split(";").at(-2))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},89798,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{HTTPAccessErrorStatus:function(){return d},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return f},getAccessFallbackErrorTypeByStatus:function(){return i},getAccessFallbackHTTPStatus:function(){return h},isHTTPAccessFallbackError:function(){return g}});let d={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},e=new Set(Object.values(d)),f="NEXT_HTTP_ERROR_FALLBACK";function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===f&&e.has(Number(c))}function h(a){return Number(a.digest.split(";")[1])}function i(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},16155,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"notFound",{enumerable:!0,get:function(){return e}});let d=""+a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE+";404";function e(){let a=Object.defineProperty(Error(d),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw a.digest=d,a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},34557,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"forbidden",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},93845,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unauthorized",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73808,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isPostpone",{enumerable:!0,get:function(){return e}});let d=Symbol.for("react.postpone");function e(a){return"object"==typeof a&&null!==a&&a.$$typeof===d}},1567,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=a.r(89798),e=a.r(28859);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},94783,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return function a(b){if((0,g.isNextRouterError)(b)||(0,f.isBailoutToCSRError)(b)||(0,i.isDynamicServerError)(b)||(0,h.isDynamicPostpone)(b)||(0,e.isPostpone)(b)||(0,d.isHangingPromiseRejectionError)(b))throw b;b instanceof Error&&"cause"in b&&a(b.cause)}}});let d=a.r(13091),e=a.r(73808),f=a.r(49640),g=a.r(1567),h=a.r(60384),i=a.r(96556);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},60968,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return d}});let d=a.r(94783).unstable_rethrow;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73727,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{ReadonlyURLSearchParams:function(){return k},RedirectType:function(){return e.RedirectType},forbidden:function(){return g.forbidden},notFound:function(){return f.notFound},permanentRedirect:function(){return d.permanentRedirect},redirect:function(){return d.redirect},unauthorized:function(){return h.unauthorized},unstable_isUnrecognizedActionError:function(){return l},unstable_rethrow:function(){return i.unstable_rethrow}});let d=a.r(44868),e=a.r(28859),f=a.r(16155),g=a.r(34557),h=a.r(93845),i=a.r(60968);class j extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class k extends URLSearchParams{append(){throw new j}delete(){throw new j}set(){throw new j}sort(){throw new j}}function l(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},70396,a=>{"use strict";a.s([]),a.i(73727)},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},29173,(a,b,c)=>{b.exports=a.x("@prisma/client",()=>require("@prisma/client"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},66518,a=>{"use strict";a.s(["prisma",()=>c]);var b=a.i(29173);let c=a.g.prisma||new b.PrismaClient({log:["query","error","warn"]})},91263,a=>{"use strict";a.s(["deleteUser",()=>i,"getUser",()=>f,"getUserId",()=>h,"getUserName",()=>g]);var b=a.i(37936),c=a.i(5246),d=a.i(55429),e=a.i(66518);async function f(){try{let a=await (0,c.cookies)(),b=a.get("token")?.value;if(!b)return null;return d.default.verify(b,process.env.JWT_SECRET)}catch(a){return console.error("Error in getUser:",a),null}}async function g(){try{let a=await f();if(!a)return null;let b=await e.prisma.user_data.findUnique({where:{user_id:a.userId,user_state:"0"},select:{user_name:!0}});return b?.user_name||null}catch(a){return console.error("Error fetching user name:",a),null}}async function h(){try{let a=await f();if(!a)return null;let b=await e.prisma.user_data.findUnique({where:{user_id:a.userId},select:{id:!0}});return b?.id||null}catch(a){return console.error("Error fetching user name:",a),null}}async function i(){try{let a=await f();if(!a)return{success:!1,error:"로그인이 필요합니다."};return await e.prisma.user_data.update({where:{user_id:a.userId},data:{user_state:"1"}}),(await (0,c.cookies)()).delete("token"),{success:!0}}catch(a){return console.error("회원 탈퇴 오류:",a),{success:!1,error:"회원 탈퇴 중 오류가 발생했습니다."}}}(0,a.i(13095).ensureServerEntryExports)([f,g,h,i]),(0,b.registerServerReference)(f,"001a9ae53cd88677b0495aa77354b1ce40f310291b",null),(0,b.registerServerReference)(g,"00015dbee12d7908d089217079a4e72d5156799e5b",null),(0,b.registerServerReference)(h,"00d012890103ff7de57a95e7edabbd73f851b4ffb8",null),(0,b.registerServerReference)(i,"00b5aaa146a4260f8b5ecf6a7cff27b9ace00e7dc9",null)},75332,a=>{"use strict";a.s(["call_login_records",()=>e]);var b=a.i(37936),c=a.i(66518),d=a.i(91263);async function e(){try{let a=await (0,d.getUser)();if(!a)return null;return await c.prisma.user_data.findUnique({where:{user_id:a.userId,user_state:"0"},select:{user_id:!0,user_main_location:!0,user_name:!0,user_email:!0,login_records:{select:{id:!0,login_time:!0,login_location:!0,login_ip:!0,login_platform:!0},orderBy:{login_time:"desc"},take:5},activities:{select:{id:!0,title:!0,difficultyLevel:!0,participants:!0,maxParticipants:!0,price:!0,date:!0,createdAt:!0},orderBy:{createdAt:"desc"},take:5},participations:{select:{id:!0,activityId:!0,createdAt:!0,activity:{select:{id:!0,title:!0,difficultyLevel:!0,participants:!0,maxParticipants:!0,price:!0,date:!0,createdAt:!0}}},orderBy:{createdAt:"desc"},take:5}}})||null}catch(a){return null}}(0,a.i(13095).ensureServerEntryExports)([e]),(0,b.registerServerReference)(e,"003d89cdc71a1e26db7edafa2c9dda5573a8d28a0f",null)},18455,a=>{"use strict";a.s(["editUserProfile",()=>f]);var b=a.i(37936),c=a.i(66518);a.i(70396);var d=a.i(73727),e=a.i(18558);async function f(a){try{let b=a.get("user_name"),d=a.get("user_email"),f=a.get("user_main_location"),g=a.get("user_id");if(!b||!d||!g)throw Error("필수 필드가 누락되었습니다.");let h=await c.prisma.user_data.findUnique({where:{user_id:g}});if(!h)throw Error("사용자를 찾을 수 없습니다.");if(await c.prisma.user_data.findFirst({where:{user_email:d,NOT:{id:h.id}}}))throw Error("이미 사용 중인 이메일입니다.");if(await c.prisma.user_data.findFirst({where:{user_name:b,NOT:{id:h.id}}}))throw Error("이미 사용 중인 이름입니다.");await c.prisma.user_data.update({where:{id:h.id},data:{user_name:b,user_email:d,user_main_location:f||null}}),(0,e.revalidatePath)("/profile"),(0,e.revalidatePath)("/profile/edit")}catch(a){throw console.error("프로필 수정 중 오류 발생:",a),a}(0,d.redirect)("/profile")}(0,a.i(13095).ensureServerEntryExports)([f]),(0,b.registerServerReference)(f,"4056bb95a3d883e2cac6a3f2f73172252aebbefc9f",null)},83796,a=>{"use strict";a.s(["00015dbee12d7908d089217079a4e72d5156799e5b",()=>h.getUserName,"001a9ae53cd88677b0495aa77354b1ce40f310291b",()=>h.getUser,"003d89cdc71a1e26db7edafa2c9dda5573a8d28a0f",()=>g.call_login_records,"00b5aaa146a4260f8b5ecf6a7cff27b9ace00e7dc9",()=>h.deleteUser,"00bf9bc1e293f156175d3d49e4edd92075726affdf",()=>f.logoutUser,"00d012890103ff7de57a95e7edabbd73f851b4ffb8",()=>h.getUserId,"4056bb95a3d883e2cac6a3f2f73172252aebbefc9f",()=>i.editUserProfile],83796),a.s([],52106);var b=a.i(12964),c=a.i(75332),d=a.i(91263),e=a.i(18455);a.i(52106);var f=b,g=c,h=d,i=e},21229,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(7997),c=a.i(97647),d=a.i(75332),e=a.i(91263),f=a.i(18455);async function g(){let a=await (0,d.call_login_records)(),g=await (0,e.getUser)();return a&&g?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"border-2 border-gray-400 m-4 p-4 rounded-lg bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"border-b-1 border-gray-400 p-2 text-lg font-semibold",children:"프로필 수정"}),(0,b.jsx)(c.default,{href:"/profile",className:"text-gray-600 hover:text-gray-800 underline",children:"← 프로필로 돌아가기"})]}),(0,b.jsxs)("form",{action:f.editUserProfile,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"user_id",value:g.userId}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 mb-2",htmlFor:"user_id_display",children:"아이디 (수정 불가)"}),(0,b.jsx)("input",{type:"text",id:"user_id_display",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",value:a.user_id,disabled:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-gray-700 mb-2",htmlFor:"user_name",children:["이름 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",id:"user_name",name:"user_name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:a.user_name,required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-gray-700 mb-2",htmlFor:"user_email",children:["이메일 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"email",id:"user_email",name:"user_email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:a.user_email,required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 mb-2",htmlFor:"user_main_location",children:"주 사용 지역"}),(0,b.jsx)("input",{type:"text",id:"user_main_location",name:"user_main_location",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:a.user_main_location||"",placeholder:"예: 서울특별시, 부산광역시 등"})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)("button",{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg transition-colors",children:"저장"}),(0,b.jsx)(c.default,{href:"/profile",className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors inline-block text-center",children:"취소"})]})]})]})})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"사용자 정보를 불러올 수 없습니다."}),(0,b.jsx)(c.default,{href:"/login",className:"text-blue-600 hover:text-blue-800 underline",children:"로그인 페이지로 이동"})]})})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__3fa229e4._.js.map