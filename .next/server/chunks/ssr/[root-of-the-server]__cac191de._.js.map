{"version":3,"sources":["turbopack:///[project]/src/actions/userLogout.ts","turbopack:///[project]/src/lib/prisma.ts","turbopack:///[project]/src/actions/userAuth.ts","turbopack:///[project]/.next-internal/server/app/example/page/actions.js (server actions loader)","turbopack:///[project]/src/component/button_logout.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/example/page.tsx"],"sourcesContent":["\"use server\";\n\nimport { cookies } from \"next/headers\";\n\nexport async function logoutUser() {\n  try {\n    // 쿠키에서 토큰 제거\n    const cookieStore = await cookies();\n    cookieStore.delete(\"token\");\n\n    console.log(\"로그아웃 성공\");\n    return { success: true };\n  } catch (error) {\n    console.error(\"로그아웃 에러:\", error);\n    return { success: false, error: \"로그아웃 중 오류가 발생했습니다.\" };\n  }\n}\n","\nimport { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['query', 'error', 'warn'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;","\"use server\";\n\nimport { cookies } from \"next/headers\";\nimport jwt from \"jsonwebtoken\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function getUser() {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"token\")?.value;\n    if (!token) {\n      return null;\n    }\n    const decoded = jwt.verify(token, process.env.JWT_SECRET!) as {\n      userId: string;\n    };\n    return decoded;\n  } catch (error) {\n    console.error(\"Error in getUser:\", error);\n    return null;\n  }\n}\n\nexport async function getUserName() {\n  try {\n    const user = await getUser();\n    if (!user) {\n      return null;\n    }\n    const userData = await prisma.user_data.findUnique({\n      where: {\n        user_id: user.userId,\n        user_state: \"0\", // 정상 회원만 조회\n      },\n      select: { user_name: true },\n    });\n    return userData?.user_name || null;\n  } catch (error) {\n    console.error(\"Error fetching user name:\", error);\n    return null;\n  }\n}\n\nexport async function getUserId() {\n  try {\n    const user = await getUser();\n    if (!user) {\n      return null;\n    }\n    const userData = await prisma.user_data.findUnique({\n      where: { user_id: user.userId },\n      select: { id: true },\n    });\n    return userData?.id || null;\n  } catch (error) {\n    console.error(\"Error fetching user name:\", error);\n    return null;\n  }\n}\n\nexport async function deleteUser() {\n  try {\n    const user = await getUser();\n    if (!user) {\n      return { success: false, error: \"로그인이 필요합니다.\" };\n    }\n\n    // user_state를 1로 변경하여 회원 탈퇴 처리\n    await prisma.user_data.update({\n      where: { user_id: user.userId },\n      data: { user_state: \"1\" },\n    });\n\n    // 쿠키에서 토큰 제거\n    const cookieStore = await cookies();\n    cookieStore.delete(\"token\");\n\n    return { success: true };\n  } catch (error) {\n    console.error(\"회원 탈퇴 오류:\", error);\n    return { success: false, error: \"회원 탈퇴 중 오류가 발생했습니다.\" };\n  }\n}\n","export {logoutUser as '00382cd68f3bd744983f7d813af84c482d62770930'} from 'ACTIONS_MODULE0'\nexport {getUserName as '002e7b5c31f1d5c9e9ffbc13cb7542adf97a620955'} from 'ACTIONS_MODULE1'\nexport {deleteUser as '0076a5f51df04de8cde300c458c94c2bfa350236c3'} from 'ACTIONS_MODULE1'\nexport {getUser as '00f965acd9a546d62fdab1033ce4b028137ef8707d'} from 'ACTIONS_MODULE1'\nexport {getUserId as '00fc13c40b730f7edcf2f80827377ccbbc19e88c2d'} from 'ACTIONS_MODULE1'\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/component/button_logout.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/component/button_logout.tsx\",\n    \"default\",\n);\n","import { getUserId } from \"@/actions/userAuth\";\nimport AuthButtons from \"@/component/auth_buttons\";\nimport ButtonLogout from \"@/component/button_logout\";\n\n// import { getUser } from \"@/actions/userAuth\";\n// const User = await getUser();\n// console.log(User?.userId);\n// 다른 페이지들에서 사용시 해당 부분 사용. 결과값 : 사용자 ID\n\n// 아래 예시는 사용자 ID를 사용해서 유저의 이름을 갖고오는 getUserName 함수를 사용한 예시.\n\n// export default async function example() {\n//   const userName = await getUserName();\n//   return (\n//     <div>\n//       <h1>메인페이지</h1>\n//       {userName ? (\n//         // 로그인 된 경우 사용자의 이름 표시\n//         <div>\n//           <p>안녕하세요, {userName}님!</p>\n//           <ButtonLogout />\n//         </div>\n//       ) : (\n//         //   비회원인 경우 (로그인,회원가입 버튼 컴포넌트 표시)\n//         <AuthButtons />\n//       )}\n//     </div>\n//   );\n// }\n\nexport default async function example() {\n  const userId = await getUserId();\n  return (\n    <div>\n      <h1>메인페이지</h1>\n      {userId ? (\n        // 로그인 된 경우 사용자의 이름 표시\n        <div>\n          <p>안녕하세요, {userId}님!</p>\n          <ButtonLogout />\n        </div>\n      ) : (\n        //   비회원인 경우 (로그인,회원가입 버튼 컴포넌트 표시)\n        <AuthButtons />\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[4]}