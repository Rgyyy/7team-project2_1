module.exports=[12964,a=>{"use strict";a.s(["logoutUser",()=>d]);var b=a.i(37936),c=a.i(5246);async function d(){try{return(await (0,c.cookies)()).delete("token"),console.log("로그아웃 성공"),{success:!0}}catch(a){return console.error("로그아웃 에러:",a),{success:!1,error:"로그아웃 중 오류가 발생했습니다."}}}(0,a.i(13095).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"00bf9bc1e293f156175d3d49e4edd92075726affdf",null)},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},29173,(a,b,c)=>{b.exports=a.x("@prisma/client",()=>require("@prisma/client"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},66518,a=>{"use strict";a.s(["prisma",()=>c]);var b=a.i(29173);let c=a.g.prisma||new b.PrismaClient({log:["query","error","warn"]})},93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},62212,a=>{a.n(a.i(66114))},12410,a=>{a.n(a.i(18381))},56395,a=>{"use strict";a.s(["getUser",()=>f]);var b=a.i(37936),c=a.i(5246),d=a.i(55429),e=a.i(66518);async function f(){try{let a=await (0,c.cookies)(),b=a.get("token")?.value;if(!b)return null;let f=d.default.verify(b,process.env.JWT_SECRET),g=await e.prisma.user_data.findUnique({where:{user_id:f.userId},select:{id:!0,user_name:!0,user_email:!0}});if(!g)return null;return{userId:g.id,userName:g.user_name,userEmail:g.user_email}}catch(a){return console.error("Error in getUser:",a),null}}async function g(){try{let a=await f();if(!a)return null;return a.userName||null}catch(a){return console.error("Error fetching user name:",a),null}}(0,a.i(13095).ensureServerEntryExports)([f,g]),(0,b.registerServerReference)(f,"009907c0a4d4b57e4f2cc262e2eb8249c8702f8171",null),(0,b.registerServerReference)(g,"00efda26df88c503c80caeef9dba9d39e240e97794",null)},42573,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/activities/[id]/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/activities/[id]/page.tsx <module evaluation>","default")},70799,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/app/activities/[id]/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/activities/[id]/page.tsx","default")},34794,a=>{"use strict";a.i(42573);var b=a.i(70799);a.n(b)},75291,a=>{"use strict";a.s(["00bf9bc1e293f156175d3d49e4edd92075726affdf",()=>j.logoutUser,"407bb8a983cae66b6c00b74fbb45ae42cbf0c414cf",()=>g,"40b5290adbc3e0cc98ad2f9b5cd455a7c6df80f0dd",()=>h],75291),a.s([],8931);var b=a.i(12964),c=a.i(37936),d=a.i(66518),e=a.i(18558),f=a.i(56395);async function g(a){try{let b=await (0,f.getUser)();if(!b?.userId)return{success:!1,error:"로그인이 필요합니다."};let c=await d.prisma.activity.findUnique({where:{id:a},include:{participations:!0}});if(!c)return{success:!1,error:"모임을 찾을 수 없습니다."};if(c.userId===b.userId)return{success:!1,error:"본인이 작성한 모임에는 참여할 수 없습니다."};if(await d.prisma.participation.findUnique({where:{activityId_userId:{activityId:a,userId:b.userId}}}))return{success:!1,error:"이미 참여한 모임입니다."};if(c.participants>=c.maxParticipants)return{success:!1,error:"참여 인원이 마감되었습니다."};return await d.prisma.participation.create({data:{activityId:a,userId:b.userId}}),await d.prisma.activity.update({where:{id:a},data:{participants:{increment:1}}}),(0,e.revalidatePath)(`/activities/${a}`),(0,e.revalidatePath)("/activities"),{success:!0,message:"모임에 참여했습니다!"}}catch(a){return console.error("Join activity error:",a),{success:!1,error:"참여에 실패했습니다."}}}async function h(a){try{let b=await (0,f.getUser)();if(!b?.userId)return{success:!1,error:"로그인이 필요합니다."};let c=await d.prisma.participation.findUnique({where:{activityId_userId:{activityId:a,userId:b.userId}}});if(!c)return{success:!1,error:"참여하지 않은 모임입니다."};return await d.prisma.participation.delete({where:{id:c.id}}),await d.prisma.activity.update({where:{id:a},data:{participants:{decrement:1}}}),(0,e.revalidatePath)(`/activities/${a}`),(0,e.revalidatePath)("/activities"),{success:!0,message:"참여를 취소했습니다."}}catch(a){return console.error("Cancel participation error:",a),{success:!1,error:"취소에 실패했습니다."}}}async function i(a){try{let b=await (0,f.getUser)();if(!b?.userId)return{isParticipating:!1};return{isParticipating:!!await d.prisma.participation.findUnique({where:{activityId_userId:{activityId:a,userId:b.userId}}})}}catch(a){return console.error("Check participation error:",a),{isParticipating:!1}}}(0,a.i(13095).ensureServerEntryExports)([g,h,i]),(0,c.registerServerReference)(g,"407bb8a983cae66b6c00b74fbb45ae42cbf0c414cf",null),(0,c.registerServerReference)(h,"40b5290adbc3e0cc98ad2f9b5cd455a7c6df80f0dd",null),(0,c.registerServerReference)(i,"408aa8ce3e37c9ca205e0dd3c17e19ebcad098e196",null),a.i(8931);var j=b}];

//# sourceMappingURL=%5Broot-of-the-server%5D__468ad45f._.js.map